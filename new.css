/* ==========================================================================
   Ultra-Stylish TOC CSS for Blogger (v3.0 - Fresh Design by AI)
   Description: A complete redesign for a modern, elegant, and user-friendly TOC.
   JS Compatibility: Maintained for existing table.js functionality.
   ========================================================================== */

/* --- Global Variables & Base Styles --- */
:root {
    /* Color Palette (Modern & Elegant) */
    --stoc-primary-color: #2C3A47;  /* गहरा नीला-ग्रे */
    --stoc-secondary-color: #182C39; /* और भी गहरा नीला-ग्रे */
    --stoc-accent-color: #4A90E2;   /* आकर्षक नीला */
    --stoc-highlight-color: #F5A623; /* वार्म ऑरेंज */
    --stoc-text-light: #FDFEFE;
    --stoc-text-dark: #34495E;
    --stoc-text-muted: #7F8C8D;
    --stoc-bg-light: #FFFFFF;
    --stoc-bg-medium: #F8F9F9;
    --stoc-border-color: #EAECEE;
    --stoc-shadow-light: rgba(44, 62, 80, 0.1);
    --stoc-shadow-medium: rgba(44, 62, 80, 0.15);

    /* Typography */
    --stoc-font-main: 'Open Sans', sans-serif;
    --stoc-font-heading: 'Montserrat', sans-serif;

    /* Dimensions & Radius */
    --stoc-border-radius: 6px;
    --stoc-sidebar-width: 280px; /* निश्चित चौड़ाई */
    --stoc-button-box-max-height-expanded: 320px;

    /* Transitions */
    --stoc-transition-fast: 0.2s ease-out;
    --stoc-transition-medium: 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
    --stoc-transition-long: 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);

    /* Highlight Effect */
    --stoc-highlight-duration: 2.5s;
    --stoc-popup-highlight-duration: 2.5s; /* For JS */
}

/* Google Fonts Import (Ensure these are linked in HTML) */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans:wght@400;600&display=swap');

/* Base element reset for TOC components */
#stoc-toc-button-wrapper *,
#stoc-floating-toc-icon *,
#stoc-toc-icon-sidebar * {
    box-sizing: border-box;
}

/* --- Collapsible Button TOC --- */
#stoc-toc-button-wrapper {
    margin-bottom: 25px;
    position: relative;
    border-radius: var(--stoc-border-radius);
    background-color: var(--stoc-bg-light);
    box-shadow: 0 4px 15px var(--stoc-shadow-light);
    border: 1px solid var(--stoc-border-color);
    overflow: hidden;
    transition: box-shadow var(--stoc-transition-fast);
}
#stoc-toc-button-wrapper:hover {
    box-shadow: 0 6px 20px var(--stoc-shadow-medium);
}

#stoc-toc-button-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 18px;
    cursor: pointer;
    color: var(--stoc-primary-color);
    user-select: none;
    position: relative;
    z-index: 2;
    background-color: var(--stoc-bg-light);
    transition: background-color var(--stoc-transition-fast);
}
#stoc-toc-button-header:hover {
    background-color: var(--stoc-bg-medium);
}

#stoc-toc-button-header h3 {
    margin: 0;
    font-family: var(--stoc-font-heading);
    font-size: 1.15em; /* थोड़ा बड़ा */
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

#stoc-toc-button-header h3 .fa-book-open { /* Or your preferred icon class */
    color: var(--stoc-accent-color);
    font-size: 1.2em;
}

.stoc-toc-button-title-text { /* Simplified and elegant */
    font-weight: 600;
}

.stoc-toc-open-prompt-icon { /* Subtle prompt */
    font-size: 0.9em;
    color: var(--stoc-text-muted);
    margin-left: 8px;
    opacity: 0; /* Initially hidden, shown when collapsed */
    transition: opacity var(--stoc-transition-fast);
}
#stoc-toc-button-wrapper.collapsed .stoc-toc-open-prompt-icon {
    opacity: 1;
}


#stoc-toc-button-toggle-icon {
    font-size: 1.2em;
    color: var(--stoc-text-muted);
    transition: transform var(--stoc-transition-medium), color var(--stoc-transition-fast);
}
#stoc-toc-button-header:hover #stoc-toc-button-toggle-icon {
    color: var(--stoc-accent-color);
}
#stoc-toc-button-wrapper.collapsed #stoc-toc-button-toggle-icon {
    transform: rotate(-90deg); /* Changed from -180 for a common "expand" look */
}
#stoc-toc-button-wrapper.expanded #stoc-toc-button-toggle-icon {
    transform: rotate(0deg);
}

#stoc-toc-button-scrollbox {
    max-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 0 18px;
    position: relative;
    transition: max-height var(--stoc-transition-long), padding var(--stoc-transition-long), opacity var(--stoc-transition-medium) 0.1s;
    border-top: 1px solid transparent; /* Transition border for smooth appearance */
    opacity: 0;
    background-color: var(--stoc-bg-light);
}

#stoc-toc-button-wrapper.expanded #stoc-toc-button-scrollbox {
    max-height: var(--stoc-button-box-max-height-expanded);
    padding: 15px 18px;
    border-top-color: var(--stoc-border-color);
    opacity: 1;
}

#stoc-toc-button-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

/* --- Floating TOC Icon & Sidebar --- */
#stoc-floating-toc-icon {
    position: fixed;
    top: 50%;
    right: -60px; /* Initially off-screen, animates in */
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    background-color: var(--stoc-primary-color);
    color: var(--stoc-text-light);
    border: none;
    border-radius: 50%;
    font-size: 1.2em; /* Icon size relative to button */
    cursor: pointer;
    z-index: 1001; /* Higher than button TOC */
    box-shadow: 0 5px 15px var(--stoc-shadow-medium);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: right var(--stoc-transition-medium), transform var(--stoc-transition-medium),
                background-color var(--stoc-transition-fast), box-shadow var(--stoc-transition-fast),
                opacity var(--stoc-transition-medium), visibility var(--stoc-transition-medium);
    opacity: 0;
    visibility: hidden;
}
#stoc-floating-toc-icon.visible {
    right: 20px;
    opacity: 1;
    visibility: visible;
}
#stoc-floating-toc-icon:hover {
    background-color: var(--stoc-accent-color);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 8px 20px var(--stoc-shadow-medium);
}
body.stoc-toc-sidebar-open #stoc-floating-toc-icon {
    right: calc(var(--stoc-sidebar-width) + 25px);
    transform: translateY(-50%) rotate(180deg); /* Spin icon when sidebar is open */
    background-color: var(--stoc-secondary-color);
}

#stoc-toc-icon-sidebar {
    position: fixed;
    top: 0;
    right: 0;
    width: var(--stoc-sidebar-width);
    height: 100vh;
    background-color: var(--stoc-bg-light);
    box-shadow: -5px 0 25px var(--stoc-shadow-medium);
    transform: translateX(100%);
    transition: transform var(--stoc-transition-long);
    z-index: 1010;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border-left: 1px solid var(--stoc-border-color);
}
#stoc-toc-icon-sidebar.visible {
    transform: translateX(0);
}

#stoc-toc-icon-sidebar-header {
    padding: 18px 20px;
    padding-right: 50px; /* Space for close button */
    border-bottom: 1px solid var(--stoc-border-color);
    flex-shrink: 0;
    position: relative;
    background-color: var(--stoc-bg-medium);
}

#stoc-toc-icon-sidebar-header h3 {
    margin: 0;
    font-family: var(--stoc-font-heading);
    font-size: 1.2em;
    font-weight: 600;
    color: var(--stoc-primary-color);
    text-align: left;
}

#stoc-toc-sidebar-internal-close {
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    width: 32px;
    height: 32px;
    font-size: 1.3em;
    color: var(--stoc-text-muted);
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
    transition: background-color var(--stoc-transition-fast), color var(--stoc-transition-fast), transform var(--stoc-transition-fast);
}
#stoc-toc-sidebar-internal-close:hover {
    background-color: var(--stoc-border-color);
    color: var(--stoc-accent-color);
    transform: translateY(-50%) rotate(90deg);
}

#stoc-toc-icon-sidebar-scrollbox {
    flex-grow: 1;
    overflow-y: auto;
    padding: 15px 0 15px 20px; /* Left padding for hierarchy lines */
    background-color: var(--stoc-bg-light);
}

#stoc-toc-icon-sidebar-list {
    list-style: none;
    padding: 0;
    margin: 0;
    position: relative; /* For hierarchy lines */
}

/* External close button (hidden by default, logic for visibility is in JS) */
#stoc-toc-sidebar-external-close {
    position: fixed;
    top: 20px;
    left: -50px; /* Initially off-screen */
    transform: translateY(0);
    width: 40px;
    height: 40px;
    background-color: var(--stoc-primary-color);
    color: var(--stoc-text-light);
    border: none;
    border-radius: 50%;
    font-size: 1.1em;
    cursor: pointer;
    box-shadow: 0 4px 12px var(--stoc-shadow-medium);
    z-index: 1011;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: left var(--stoc-transition-medium), opacity var(--stoc-transition-medium), visibility var(--stoc-transition-medium), background-color var(--stoc-transition-fast);
}
#stoc-toc-sidebar-external-close.visible {
    left: 20px;
    opacity: 1;
    visibility: visible;
}
#stoc-toc-sidebar-external-close:hover {
    background-color: var(--stoc-accent-color);
}


/* --- Shared TOC List Item Styling --- */
.stoc-toc-list-item {
    margin-bottom: 2px; /* Reduced margin */
    position: relative;
    border-radius: 0; /* Clean lines, hierarchy handled by padding/borders */
    padding: 0;
    background: none;
    transition: background-color var(--stoc-transition-fast);
}

.stoc-toc-list-item a {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 15px; /* Sidebar items will have right padding from scrollbox */
    #stoc-toc-button-scrollbox & { /* Specific padding for button TOC items */
        padding-right: 15px;
        padding-left: 15px;
    }
    text-decoration: none;
    color: var(--stoc-text-dark);
    font-family: var(--stoc-font-main);
    font-size: 0.9em;
    font-weight: 400;
    border-left: 3px solid transparent; /* Hierarchy indicator */
    transition: background-color var(--stoc-transition-fast), border-left-color var(--stoc-transition-fast), color var(--stoc-transition-fast);
    position: relative; /* For ::before pseudo-element */
}
.stoc-toc-list-item a:hover {
    background-color: var(--stoc-bg-medium);
    color: var(--stoc-accent-color);
    border-left-color: var(--stoc-accent-color);
}
.stoc-toc-list-item a.stoc-toc-link-clicked {
    background-color: var(--stoc-bg-medium);
    color: var(--stoc-highlight-color);
    font-weight: 600;
    border-left-color: var(--stoc-highlight-color) !important; /* Ensure active border is visible */
}
.stoc-toc-list-item a.stoc-toc-link-clicked::before {
    content: '';
    position: absolute;
    left: -3px; /* Align with border */
    top: 0;
    bottom: 0;
    width: 3px;
    background-color: var(--stoc-highlight-color);
    border-top-right-radius: 2px;
    border-bottom-right-radius: 2px;
}


.stoc-toc-list-item .stoc-toc-item-icon {
    font-size: 0.8em; /* Smaller, more subtle icon */
    width: 1.3em;
    text-align: center;
    color: var(--stoc-text-muted);
    transition: color var(--stoc-transition-fast), transform var(--stoc-transition-fast);
    flex-shrink: 0;
}
.stoc-toc-list-item a:hover .stoc-toc-item-icon,
.stoc-toc-list-item a.stoc-toc-link-clicked .stoc-toc-item-icon {
    color: inherit; /* Inherit color from parent <a> tag */
    transform: scale(1.1);
}

.stoc-toc-list-item .stoc-toc-item-text {
    flex-grow: 1;
    line-height: 1.5;
    white-space: normal;
    word-break: break-word;
}

/* --- Hierarchy Styling (Padding for indentation) --- */
.stoc-toc-list-item.level-2 a { font-weight: 600; font-size: 0.92em; }
/* Sidebar specific indentation */
#stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-2 a { padding-left: 15px; }
#stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-3 a { padding-left: 30px; border-left-color: var(--stoc-border-color);}
#stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-4 a { padding-left: 45px; border-left-color: var(--stoc-border-color); font-size: 0.88em;}
#stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-5 a { padding-left: 60px; border-left-color: var(--stoc-border-color); font-size: 0.88em;}
#stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-6 a { padding-left: 75px; border-left-color: var(--stoc-border-color); font-size: 0.88em;}

/* Button TOC specific indentation (less aggressive) */
#stoc-toc-button-list .stoc-toc-list-item.level-3 a { padding-left: 25px; }
#stoc-toc-button-list .stoc-toc-list-item.level-4 a { padding-left: 35px; font-size: 0.88em;}
#stoc-toc-button-list .stoc-toc-list-item.level-5 a { padding-left: 45px; font-size: 0.88em;}
#stoc-toc-button-list .stoc-toc-list-item.level-6 a { padding-left: 55px; font-size: 0.88em;}


/* --- Shared Scroll Indicator --- */
.stoc-toc-scroll-indicator {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.3em;
    opacity: 0;
    pointer-events: none;
    color: var(--stoc-text-muted);
    animation: stoc-bounce-subtle 2s infinite ease-in-out;
    transition: opacity var(--stoc-transition-medium);
}
.stoc-toc-scroll-indicator.visible {
    opacity: 0.6;
}
@keyframes stoc-bounce-subtle {
    0%, 100% { transform: translate(-50%, 0px); }
    50% { transform: translate(-50%, -4px); }
}

/* --- Custom Scrollbars --- */
#stoc-toc-button-scrollbox::-webkit-scrollbar,
#stoc-toc-icon-sidebar-scrollbox::-webkit-scrollbar {
    width: 8px;
}
#stoc-toc-button-scrollbox::-webkit-scrollbar-track,
#stoc-toc-icon-sidebar-scrollbox::-webkit-scrollbar-track {
    background: var(--stoc-bg-medium);
    border-radius: 4px;
}
#stoc-toc-button-scrollbox::-webkit-scrollbar-thumb,
#stoc-toc-icon-sidebar-scrollbox::-webkit-scrollbar-thumb {
    background-color: var(--stoc-text-muted);
    border-radius: 4px;
    border: 2px solid var(--stoc-bg-medium); /* Creates a "track" around thumb */
}
#stoc-toc-button-scrollbox::-webkit-scrollbar-thumb:hover,
#stoc-toc-icon-sidebar-scrollbox::-webkit-scrollbar-thumb:hover {
    background-color: var(--stoc-accent-color);
}
#stoc-toc-button-scrollbox,
#stoc-toc-icon-sidebar-scrollbox {
    scrollbar-width: thin;
    scrollbar-color: var(--stoc-text-muted) var(--stoc-bg-medium);
}

/* --- Content Highlighting --- */
@keyframes stoc-target-highlight-pulse {
  0% { background-color: rgba(245, 166, 35, 0.05); box-shadow: 0 0 0 0 rgba(245, 166, 35, 0.2); }
  70% { background-color: rgba(245, 166, 35, 0.15); box-shadow: 0 0 0 10px rgba(245, 166, 35, 0); }
  100% { background-color: rgba(245, 166, 35, 0.05); box-shadow: 0 0 0 0 rgba(245, 166, 35, 0); }
}

.stoc-toc-target-heading {
    position: relative;
    color: var(--stoc-highlight-color) !important;
    transition: color var(--stoc-transition-medium) var(--stoc-popup-highlight-duration); /* Delay color fade */
    /* No border animation for a cleaner look, color change is primary indicator */
}
.stoc-toc-target-heading.fading-out {
    color: inherit !important;
}

.stoc-toc-target-paragraph {
    padding: 10px;
    margin: 5px -10px; /* Slight negative margin to "pop" */
    border-radius: var(--stoc-border-radius);
    animation: stoc-target-highlight-pulse calc(var(--stoc-highlight-duration) / 2) ease-out 2; /* Run twice */
    transition: background-color 0.3s ease, box-shadow 0.3s ease, padding 0.3s ease, margin 0.3s ease;
    transition-delay: calc(var(--stoc-popup-highlight-duration) - 0.3s);
}
.stoc-toc-target-paragraph.fading-out {
    background-color: transparent !important;
    box-shadow: none !important;
    padding: 0;
    margin: 0 0 1em 0; /* Default paragraph margin */
    animation: none;
}


/* --- Responsive Adjustments --- */
@media (max-width: 768px) {
    :root {
        --stoc-sidebar-width: 260px; /* Slightly narrower on mobile */
    }
    #stoc-floating-toc-icon.visible {
        right: 15px;
        width: 44px;
        height: 44px;
        font-size: 1.1em;
    }
    body.stoc-toc-sidebar-open #stoc-floating-toc-icon {
        right: calc(var(--stoc-sidebar-width) + 15px);
    }
    #stoc-toc-icon-sidebar-header { padding: 15px 45px 15px 15px; }
    #stoc-toc-icon-sidebar-header h3 { font-size: 1.1em; }
    #stoc-toc-sidebar-internal-close { right: 10px; width: 30px; height: 30px; font-size: 1.2em;}

    #stoc-toc-button-header h3 { font-size: 1.05em; }
    #stoc-toc-button-header { padding: 12px 15px; }
    .stoc-toc-list-item a { font-size: 0.88em; padding: 9px 12px; }
    #stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-3 a { padding-left: 25px; }
    #stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-4 a { padding-left: 35px; }
    #stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-5 a { padding-left: 45px; }
    #stoc-toc-icon-sidebar-list .stoc-toc-list-item.level-6 a { padding-left: 55px; }

    #stoc-toc-sidebar-external-close.visible { left: 15px; width: 36px; height: 36px; font-size: 1em; }
}


/* --- Accessibility: Reduced Motion --- */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
        transition-delay: 0ms !important;
    }

    /* Keep essential transform for open/close but instant */
    #stoc-toc-button-toggle-icon { transition: transform 0.01ms !important; }
    #stoc-toc-button-scrollbox { transition: max-height 0.01ms, padding 0.01ms, opacity 0.01ms !important; }
    #stoc-toc-icon-sidebar { transition: transform 0.01ms !important; }
    #stoc-floating-toc-icon { transition: right 0.01ms, transform 0.01ms, opacity 0.01ms, visibility 0.01ms !important; }
    #stoc-toc-sidebar-external-close { transition: left 0.01ms, opacity 0.01ms, visibility 0.01ms !important; }

    /* Disable decorative animations */
    .stoc-toc-open-prompt-icon,
    #stoc-floating-toc-icon,
    #stoc-floating-toc-icon:hover, /* No scale/rotate on hover */
    body.stoc-toc-sidebar-open #stoc-floating-toc-icon, /* No rotate */
    #stoc-toc-sidebar-internal-close:hover, /* No rotate */
    .stoc-toc-scroll-indicator,
    .stoc-toc-target-paragraph,
    .stoc-toc-list-item a.stoc-toc-link-clicked::before /* No animation */
     {
        animation: none !important;
    }
    #stoc-floating-toc-icon:hover {
        transform: translateY(-50%) scale(1.05) !important; /* Just subtle scale */
    }
    body.stoc-toc-sidebar-open #stoc-floating-toc-icon {
        transform: translateY(-50%) !important;
    }
    #stoc-toc-sidebar-internal-close:hover {
        transform: translateY(-50%) scale(1.05) !important; /* Just subtle scale */
    }
}

/* --- Post Content Headings (Adjust scroll-margin-top as needed) --- */
.post-body h1,
.post-body h2,
.post-body h3,
.post-body h4,
.post-body h5,
.post-body h6 {
    font-family: var(--stoc-font-heading);
    scroll-margin-top: 80px; /* Adjust if you have a fixed header */
    position: relative; /* Required for the ::before pseudo-element if used */
}

/* Optional: Anchor offset for fixed headers (if JS doesn't handle it perfectly) */
/*
.post-body h1::before, .post-body h2::before, .post-body h3::before,
.post-body h4::before, .post-body h5::before, .post-body h6::before {
    content: "";
    display: block;
    height: 80px; 
    margin-top: -80px; 
    visibility: hidden;
    pointer-events: none;
}
*/

/* --- End of Ultra-Stylish TOC CSS --- */
