/* ==========================================================================
   Vedic Bloom TOC CSS for Blogger (v4.7 - Fixed Highlighting, Scroll Indicator, BG Pattern)
   Description: Ensured content highlighting and scroll indicator functionality.
                Corrected button TOC background pattern application.
   JS Compatibility: Maintained.
   ========================================================================== */

/* --- Global Variables & Base Styles (v4.6 से, कुछ समायोजन) --- */
:root {
    /* Vedic Color Palette */
    --stoc-pink-very-deep: #A0144F;
    --stoc-ruby-deep: #A70404;
    --stoc-ruby-highlight: #D32F2F;
    --stoc-saffron: #FFA000;
    --stoc-gold-text: #FFD700;
    --stoc-gold-pattern: rgba(255, 215, 0, 0.22); /* पैटर्न थोड़ा और सूक्ष्म */
    --stoc-gold-pattern-strong: rgba(255, 215, 0, 0.35);
    --stoc-gold-highlight: #FFEE58;
    --stoc-gold-border: #FFB300;
    --stoc-copper: #A1887F;
    --stoc-text-glow: rgba(255, 223, 186, 0.3); /* चमक थोड़ी कम */

    /* Text & Background */
    --stoc-text-light-on-dark: #FFFDE7;
    --stoc-text-dark-on-light: #4E342E;
    --stoc-bg-light: #FFFDF5;
    --stoc-border-color-light: #FFCC80;

    /* Typography */
    --stoc-font-main: 'Laila', 'Noto Sans Devanagari', serif;
    --stoc-font-heading: 'Martel', 'Noto Serif Devanagari', serif;

    /* Dimensions & Radius */
    --stoc-border-radius: 10px;
    --stoc-sidebar-width: 290px;
    --stoc-button-box-max-height-expanded: 350px;

    /* Transitions & Animations */
    --stoc-transition-fast: 0.25s ease-in-out;
    --stoc-transition-medium: 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    --stoc-transition-reveal: 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);

    /* Highlight Effect - For JS to use */
    --stoc-highlight-duration: 3s; /* 3000ms */
    --stoc-popup-highlight-duration: 3s; /* Legacy, ensure JS uses the one above */

    /* स्क्रॉल इंडिकेटर के लिए रंग */
    --stoc-scroll-indicator-color: var(--stoc-gold-text); /* v1.4 से --stoc-color-1 जैसा */
}

/* Google Fonts Import (पहले जैसे) */
@import url('https://fonts.googleapis.com/css2?family=Laila:wght@400;600;700&family=Martel:wght@600;700;800&family=Noto+Sans+Devanagari:wght@400;600&family=Noto+Serif+Devanagari:wght@600;700&display=swap');

/* Base element reset (पहले जैसे) */
#stoc-toc-button-wrapper *,
#stoc-floating-toc-icon *,
#stoc-toc-icon-sidebar * {
    box-sizing: border-box;
    line-height: 1.5;
}
#stoc-toc-button-list,
#stoc-toc-icon-sidebar-list {
    line-height: 1.45;
}

/* --- Design Patterns (पहले जैसे) --- */
/* डिज़ाइन 1: फ्लोटिंग साइडबार के लिए (जाल/बेलबूटे जैसा) */
#stoc-toc-icon-sidebar { /* पैटर्न अब सीधे साइडबार पर लागू होगा */
    background-color: var(--stoc-ruby-deep);
    position: relative; /* ::before के लिए */
}
#stoc-toc-icon-sidebar::before {
    content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-image:
        repeating-linear-gradient(45deg, transparent, transparent 10px, var(--stoc-gold-pattern) 10px, var(--stoc-gold-pattern) 11.5px),
        repeating-linear-gradient(-45deg, transparent, transparent 10px, var(--stoc-gold-pattern) 10px, var(--stoc-gold-pattern) 11.5px),
        radial-gradient(circle at center, var(--stoc-gold-pattern-strong) 1px, transparent 1.5px);
    background-size: 30px 30px, 30px 30px, 15px 15px;
    background-position: 0 0, 0 0, 0 0; opacity: 0.7; /* थोड़ी कम ओपेसिटी */
    pointer-events: none; mix-blend-mode: overlay; z-index: 0;
    border-radius: 0; /* साइडबार में कोई रेडियस नहीं */
}
#stoc-toc-icon-sidebar > * { /* साइडबार की सामग्री पैटर्न के ऊपर हो */
    position: relative; z-index: 1;
}

/* डिज़ाइन 2: बटन रैपर TOC स्क्रॉलबॉक्स के लिए (मंडला/बूटी जैसा) */
#stoc-toc-button-scrollbox {
    background-color: var(--stoc-pink-very-deep);
    position: relative; /* ::before के लिए */
    z-index: 1; /* हेडर के नीचे */
}
#stoc-toc-button-scrollbox::before {
    content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background-image:
        radial-gradient(circle at center, var(--stoc-gold-pattern-strong) 2.5px, transparent 3px),
        radial-gradient(var(--stoc-gold-pattern) 1px, transparent 1.2px),
        radial-gradient(var(--stoc-gold-pattern) 1px, transparent 1.2px);
    background-size: 40px 40px, 15px 15px, 15px 15px;
    background-position: center center, 0 0, 7.5px 7.5px;
    opacity: 0.8; /* थोड़ी कम ओपेसिटी */
    pointer-events: none;
    border-radius: inherit; /* स्क्रॉलबॉक्स का रेडियस */
    mix-blend-mode: luminosity;
    z-index: -1; /* सामग्री के पीछे */
}


/* --- Collapsible Button TOC (पहले जैसे, z-index समायोजित) --- */
#stoc-toc-button-wrapper {
    /* ... (v4.6 से स्टाइल) ... */
    overflow: hidden; /* सुनिश्चित करें कि ::before अंदर रहे */
}
#stoc-toc-button-wrapper::after { /* अलंकृत बॉर्डर */
    /* ... (v4.6 से स्टाइल) ... */
    z-index: 3; /* हेडर के ऊपर, स्क्रॉलबॉक्स पैटर्न के भी ऊपर */
}
#stoc-toc-button-wrapper > div:not(#stoc-toc-button-scrollbox) { /* हेडर */
    position: relative; z-index: 2;
}
#stoc-toc-button-header { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-button-header h3 { /* ... */ }
#stoc-toc-button-header h3 .fa-book-open { /* ... */ }
.stoc-toc-button-title-text { /* ... */ }
.stoc-toc-open-prompt-icon { /* ... */ }
#stoc-toc-button-toggle-icon { /* ... */ }

#stoc-toc-button-scrollbox {
    /* ... (v4.6 से स्टाइल, background-color और ::before ऊपर परिभाषित) ... */
    border-bottom-left-radius: calc(var(--stoc-border-radius) - 3px); /* महत्वपूर्ण है overflow:hidden के साथ */
    border-bottom-right-radius: calc(var(--stoc-border-radius) - 3px);
}
#stoc-toc-button-wrapper.expanded #stoc-toc-button-scrollbox { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-button-list { /* ... (v4.6 से स्टाइल) ... */ }


/* --- Floating TOC Icon & Sidebar (पहले जैसे, ::before ऊपर परिभाषित) --- */
#stoc-floating-toc-icon { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-icon-sidebar {
    /* ... (v4.6 से स्टाइल, background-color और ::before ऊपर परिभाषित) ... */
    overflow: hidden; /* ::before को क्लिप करने के लिए */
}
#stoc-toc-icon-sidebar-header { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-sidebar-internal-close { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-icon-sidebar-scrollbox {
    flex-grow: 1; overflow-y: auto; padding: 15px 5px 15px 18px;
    /* नोट: साइडबार स्क्रॉलबॉक्स का अपना ::before पैटर्न नहीं होगा, यह पैरेंट (#stoc-toc-icon-sidebar) से इनहेरिट करेगा */
    background-color: transparent; /* पैरेंट का पैटर्न दिखने दें */
}
#stoc-toc-icon-sidebar-list { /* ... (v4.6 से स्टाइल) ... */ }
#stoc-toc-sidebar-external-close { /* ... (v4.6 से स्टाइल) ... */ }


/* --- Shared TOC List Item Styling (पहले जैसे) --- */
/* ... (v4.6 से लिस्ट आइटम स्टाइल) ... */
.stoc-toc-list-item a {
    color: var(--stoc-gold-text);
    text-shadow: 0 0 7px rgba(var(--stoc-saffron), 0.7), 1px 1px 1.5px rgba(0,0,0,0.4);
}


/* --- Hierarchy Styling (पहले जैसे) --- */
/* ... (v4.6 से पदानुक्रम स्टाइल) ... */


/* --- साझा स्क्रॉल इंडिकेटर (v1.4 से कार्यक्षमता, v4.6 से स्टाइल) --- */
.stoc-toc-scroll-indicator {
    position: absolute;
    bottom: 10px; /* थोड़ा ऊपर */
    left: 50%;
    transform: translateX(-50%);
    font-size: 1.6em; /* थोड़ा बड़ा */
    opacity: 0; /* JS द्वारा .visible क्लास से नियंत्रित होगा */
    pointer-events: none;
    color: var(--stoc-scroll-indicator-color); /* वेरिएबल का उपयोग */
    text-shadow: 0 0 8px rgba(var(--stoc-saffron), 0.6); /* सुनहरी चमक */
    animation: stoc-bounce-pulse-vedic 2s infinite ease-in-out;
    transition: opacity 0.4s ease;
    z-index: 5; /* सुनिश्चित करें कि यह सूची के ऊपर है */
}
.stoc-toc-scroll-indicator.visible { /* यह क्लास JS द्वारा जोड़ी जाएगी */
    opacity: 0.85;
}
@keyframes stoc-bounce-pulse-vedic { /* v1.4 से stoc-bounce-pulse जैसा */
    0%, 100% { transform: translate(-50%, 0px) scale(1); opacity: 0.7; }
    50% { transform: translate(-50%, -6px) scale(1.05); opacity: 1; }
}


/* --- Custom Scrollbars (पहले जैसे) --- */
/* ... (v4.6 से स्क्रॉलबार स्टाइल) ... */


/* --- कंटेंट हाइलाइटिंग (v1.4 से कार्यक्षमता, v4.6 से स्टाइल समायोजित) --- */
/* यह सुनिश्चित करना है कि JS द्वारा जोड़ी गई क्लास सही ढंग से काम करें */
/* .stoc-toc-target-heading और .stoc-toc-target-paragraph को जावास्क्रिप्ट द्वारा जोड़ा जाएगा */

/* हाइलाइटेड हेडिंग के लिए एनिमेशन */
@keyframes stoc-highlight-heading-animation-vedic {
  0%, 100% {
    text-shadow: 0 0 6px var(--stoc-gold-highlight), 0 0 12px var(--stoc-saffron), 0 0 2px var(--stoc-text-light-on-dark);
    color: var(--stoc-ruby-highlight) !important;
    transform: scale(1.01);
  }
  50% {
    text-shadow: 0 0 10px var(--stoc-gold-highlight), 0 0 20px var(--stoc-saffron), 0 0 30px var(--stoc-ruby-highlight), 0 0 3px var(--stoc-text-light-on-dark);
    color: var(--stoc-pink-very-deep) !important;
    transform: scale(1.04);
  }
}

/* हाइलाइटेड पैराग्राफ के लिए एनिमेशन */
@keyframes stoc-highlight-paragraph-animation-vedic {
  0%, 100% {
    background-color: rgba(255, 224, 178, 0.2); /* हल्का केसरिया टिंट */
    box-shadow: 0 0 10px rgba(255,202,40,0.25), inset 0 0 6px rgba(255,160,0,0.15), 0 0 0 1.5px rgba(var(--stoc-gold-border), 0.4);
  }
  50% {
    background-color: rgba(255, 224, 178, 0.35); /* थोड़ा और गहरा */
    box-shadow: 0 0 20px rgba(255,202,40,0.45), inset 0 0 12px rgba(255,160,0,0.3), 0 0 0 2px rgba(var(--stoc-gold-border), 0.6);
  }
}

/* यह क्लास JS द्वारा हेडिंग में जोड़ी जाएगी */
.stoc-toc-target-heading {
    position: relative; /* एनिमेशन के लिए */
    padding: 3px 5px; margin: 0 -5px; border-radius: 4px;
    animation-name: stoc-highlight-heading-animation-vedic;
    animation-duration: var(--stoc-highlight-duration); /* CSS वेरिएबल का उपयोग */
    animation-timing-function: ease-in-out;
    animation-iteration-count: 1; /* एक बार चले */
    animation-fill-mode: forwards; /* अंतिम स्थिति बनाए रखे */
    transition: color 0.3s ease-out, text-shadow 0.3s ease-out, transform 0.3s ease-out; /* फीका पड़ने के लिए */
    transition-delay: var(--stoc-highlight-duration); /* एनिमेशन खत्म होने के बाद ट्रांजिशन शुरू हो */
    will-change: text-shadow, color, transform;
}
/* यह क्लास JS द्वारा पैराग्राफ में जोड़ी जाएगी */
.stoc-toc-target-paragraph {
    position: relative;
    padding: 12px; margin: 8px -12px; border-radius: var(--stoc-border-radius);
    animation-name: stoc-highlight-paragraph-animation-vedic;
    animation-duration: var(--stoc-highlight-duration);
    animation-timing-function: ease-in-out;
    animation-iteration-count: 1;
    animation-fill-mode: forwards;
    transition: background-color 0.3s ease-out, box-shadow 0.3s ease-out, padding 0.3s ease-out, margin 0.3s ease-out;
    transition-delay: var(--stoc-highlight-duration);
    will-change: background-color, box-shadow;
}

/* यह क्लास JS द्वारा हाइलाइट अवधि के बाद जोड़ी जाएगी ताकि स्टाइल रीसेट हो सकें */
.stoc-toc-target-heading.fading-out,
.stoc-toc-target-paragraph.fading-out {
    animation: none !important; /* चल रहे एनिमेशन को रोकें */
    /* ट्रांजिशन के माध्यम से मूल स्थिति में लौटें */
    color: inherit !important;
    text-shadow: none !important;
    transform: scale(1) !important;
    background-color: transparent !important;
    box-shadow: none !important;
    padding: 0 !important; /* मूल पैडिंग पर रीसेट करें या हटा दें */
    margin: 0 0 1em 0 !important; /* पैराग्राफ के लिए मूल मार्जिन */
}
.stoc-toc-target-heading.fading-out { margin: 0 !important; } /* हेडिंग के लिए मार्जिन रीसेट */


/* --- Responsive & Accessibility (पहले जैसे) --- */
@media (max-width: 768px) { /* ... (v4.6 से स्टाइल) ... */ }
@media (prefers-reduced-motion: reduce) { /* ... (v4.6 से स्टाइल) ... */ }

/* --- Post Content Headings (पहले जैसे) --- */
.post-body h1, .post-body h2, .post-body h3,
.post-body h4, .post-body h5, .post-body h6 {
    font-family: var(--stoc-font-heading);
    scroll-margin-top: 90px;
    position: relative;
    color: var(--stoc-text-dark-on-light);
}

/* --- End of Vedic Bloom TOC CSS --- */
